<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>首页</title>
	<!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
	<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
 	<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<style>
		ul,li{
			list-style: none;
			margin: 0;
		}
		.control{
			visibility: hidden;;
		}
	</style>
	</head>
<body>
<header>
	<div class="h3 col-lg-12 bg-info">Leoc——记事共享</div>
	<h4>{$check}</h4>
	<button onclick="Control()">编辑</button>
</header>
<content>
<div class="col-lg-8 col-lg-offset-2">

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#my_records" aria-controls="home" role="tab" data-toggle="tab">my_records</a></li>
    <li role="presentation"><a href="#add_record" aria-controls="add_record" role="tab" data-toggle="tab">add_record</a></li>
    <li role="presentation"><a href="#friends_records" aria-controls="friends_records" role="tab" data-toggle="tab">friends_records</a></li>
    <li role="presentation"><a href="#friends_list" aria-controls="friends_list" role="tab" data-toggle="tab">friends_list</a></li>
    <li role="presentation"><a href="#add_friend" aria-controls="add_friend" role="tab" data-toggle="tab">add_friend</a></li>
    <li role="presentation"><a href="#logout" aria-controls="logout" role="tab" data-toggle="tab">logout</a></li>
  </ul>
 <!-- Tab panes -->
	<div class="tab-content">
	  <div role="tabpanel" class="tab-pane fade in active" id="my_records">
		<h2>我的记事</h2>
		{if condition="!empty($recordList)"}
		<ul class="list">
			{volist name='recordList' id='item'}
			<li>
			<div class="panel panel-default">
			  <div class="panel-heading">
			  <span class="h3">{$item.title}</span>
			 <!--  <span class="h3 small pull-right">作者:{$item.author}</span> -->
			  <span class="h3 small pull-right">添加时间:{$item.create_time}</span>
			  </div>
			  <div class="panel-body">
			    {$item.content}
			    <div class="control">
				    <a class="btn btn-danger" href="index/deleteRecord?user_id={$item.user_id}&id={$item.id}" >删除</a>
					<button type="button" class="btn btn-warning" onclick="Load({$item.id})" data-toggle="modal" data-target="#update_record">编辑</button>
				</div>
			  </div>
			</div>
			</li>
			{/volist}
		</ul>
		{else/}
		<h1>获取用户记事列表失败</h1>
		{/if}
	  </div>
	  <div role="tabpanel" class="tab-pane fade" id="add_record">
	  	<h2>添加记事</h2>
		<form class="form-group" action="index/addRecord" method="post">
			title:<input class="form-control" type="text" name="title"><br>
			content: <textarea class="form-control" name="content"  cols="30" rows="10"></textarea>
			<input class="form-control" type="submit" value="add">	
		</form>
	  </div>
	  <div role="tabpanel" class="tab-pane fade" id="friends_records">
	  	<h2>好友记事</h2>
		{if condition="!empty($friendsRecordList)"}
		<ul class="list">
			{volist name='friendsRecordList' id='item'}
			<li>
			<div class="panel panel-default">
			  <div class="panel-heading">
			  <span class="h3">{$item.title}</span>
			  <span class="h3 small pull-right">作者:{$item.author}</span>
			  <span class="h3 small pull-right">添加时间:{$item.create_time}</span>
			  </div>
			  <div class="panel-body">
			    {$item.content}
			  </div>
			</div>
			</li>
			{/volist}
		</ul>
		{else/}
		<h1>获取用户记事列表失败</h1>
		{/if}
	  </div>
	  <div role="tabpanel" class="tab-pane fade" id="friends_list">
	  	<h2>关注列表</h2>
		<ul class="list">
		{volist name='friendList' id='item' }
			<li>{$item.friend_name} 
			<a href="index/deleteFriend?friend_id={$item.friend_id}">删除</a>
			</li>
		{/volist}
		</ul>
	  </div>
	  <div role="tabpanel" class="tab-pane fade" id="add_friend">
	  	<h2>添加好友</h2>
		<form class="form-group" action="index/addFriend" method="get">
			name:<input class="form-control" type="text" name="user_name"><br>
			<input class="form-control" type="submit" value="add">	
		</form>
	  </div>
	  <div role="tabpanel" class="tab-pane fade" id="logout">
		<a href="index/logout">注销</a>
	  </div>
	</div>
</div>
</content>

<div id="update_record" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">编辑记事</h4>
      </div>
      <div class="modal-body">
		<form action="index/updateRecord" method="POST" role="form">
	    <legend></legend>
	
	    <div class="form-group">
	        <label for="">请修改原来的记事</label>
	        <input id="old_record" name="content" type="text" class="form-control"  placeholder="">
	        <input type="hidden" name="id" id="old_record_id" >
	        <input type="hidden" name="user_id" id="user_id" >
	    </div>
	    <button type="submit"  class="btn btn-primary">保存</button>
		</form>        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->




<footer>
	
</footer>	

<script>
	
	function Load(record_id)
	{
		console.log(record_id);

		$.ajax({
			url: '/index.php/index/record.Record/getSingleRecord',
			type: 'GET',
			//dataType: 'default: Intelligent Guess (Other values: xml, json, script, or html)',
			data: {id:record_id },

		})
		.done(function(data) {
			console.log("success");
			console.log(data);
			$('#old_record').val(data.content);
			$('#old_record_id').val(data.id);
			$('#user_id').val(data.user_id);
		})
		.fail(function() {
			console.log("error");
		})
		.always(function() {
			console.log("complete");
		});
	}
	function Control(){
		console.log('hello');
		flag=$(".control").css("visibility");
		if(flag=="hidden")
			$(".control").css("visibility","visible");
		else
			$(".control").css("visibility","hidden");
	}
</script>	
</body>
</html>	